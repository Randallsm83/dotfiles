# =============================================================================
# MISE CONFIGURATION
# =============================================================================
# Platform-specific tool management strategy:
#
#   Windows:
#     - mise: Language runtimes (node, python, ruby, go, rust, bun, deno, etc.)
#     - scoop: CLI tools (bat, eza, fd, ripgrep, starship, neovim, etc.)
#     - winget: GUI applications
#
#   Linux/WSL/macOS:
#     - mise: Everything (CLI tools + language runtimes)
#     - homebrew: macOS GUI apps only (warp, wezterm)
# =============================================================================

[tools]
# === Language Runtimes ===
{{- if .package_features.node }}
node = "lts"
{{- end }}
{{- if .package_features.python }}
python = "latest"
{{- end }}
{{- if .package_features.ruby }}
ruby = "latest"
{{- end }}
{{- if .package_features.golang }}
go = "latest"
{{- end }}
{{- if .package_features.rust }}
rust = "stable"
{{- end }}
{{- if and .package_features.lua (ne .chezmoi.os "windows") }}
lua = "latest"
luajit = "latest"
{{- end }}
zig = "latest"
{{- if and .package_features.perl (ne .chezmoi.os "windows") }}
perl = "latest"
{{- end }}
{{- if .package_features.php }}
php = "latest"
{{- end }}

# === Universal Tools ===
{{- if .package_features.direnv }}
direnv = "latest"
{{- end }}
{{- range .always_install.mise }}
{{ . }} = "latest"
{{- end }}
{{- if .package_features.node }}
bun = "latest"
deno = "latest"
yarn = "latest"
{{- end }}
{{- if .package_features.python }}
uv = "latest"
{{- if ne .chezmoi.os "windows" }}
pipx = "latest"
{{- end }}
{{- end }}

{{- if ne .chezmoi.os "windows" }}
# === CLI Tools (Linux/WSL/macOS) ===
{{- if .package_features.git }}
github-cli = "latest"  # gh
{{- end }}
{{- if .package_features.nvim }}
neovim = "latest"
{{- end }}
{{- if .package_features.vim }}
vim = "latest"
{{- end }}
{{- if .package_features.starship }}
starship = "latest"
{{- end }}
{{- if .package_features.bat }}
"github:sharkdp/bat" = "latest"
{{- end }}
{{- if .package_features.eza }}
"github:eza-community/eza" = "latest"
{{- end }}
{{- if .package_features.ripgrep }}
"github:BurntSushi/ripgrep" = "latest"
{{- end }}
{{- if .package_features.fd }}
"github:sharkdp/fd" = "latest"
{{- end }}
{{- if .package_features.fzf }}
fzf = "latest"
{{- end }}
{{- if .package_features.zoxide }}
"github:ajeetdsouza/zoxide" = "latest"
{{- end }}
{{- if .package_features.delta }}
"github:dandavison/delta" = "latest"
{{- end }}
{{- if .package_features.vivid }}
"github:sharkdp/vivid" = "latest"
{{- end }}
{{- if .package_features.glow }}
glow = "latest"
{{- end }}
{{- if .package_features.bat }}
bat-extras = "latest"
{{- end }}
{{- if .package_features.btop }}
"github:aristocratos/btop" = "latest"
{{- end }}
{{- if .package_features.sqlite3 }}
sqlite = "latest"
{{- end }}

# Build tools
cargo-binstall = "latest"
chezmoi = "latest"
{{- if .package_features.thefuck }}
# thefuck requires git install due to setuptools issues in Python 3.12+
"pipx:git+https://github.com/nvbn/thefuck.git" = "master"
{{- end }}
{{- end }}

[settings]
idiomatic_version_file = true
idiomatic_version_file_disable_tools = []
always_keep_download = false
always_keep_install = false
plugin_autoupdate_last_check_duration = '1 week'
trusted_config_paths = ['']
verbose = false
http_timeout = "30s"
jobs = 4
raw = false
yes = false
not_found_auto_install = false
task_output = "prefix"
paranoid = false
shorthands_file = '~/.config/mise/shorthands.toml'
disable_default_shorthands = false
experimental = true
status = { missing_tools = "if_other_versions_installed", show_env = false, show_tools = false }

{{- if eq .chezmoi.os "windows" }}
# Disable tools that don't work well via mise on Windows
disable_tools = ["lua", "luajit"]
ignored_config_paths = []
{{- else }}
disable_tools = []
# Ignore Windows config path mounted via WSL interop
ignored_config_paths = ["/mnt/c", "/mnt/d"]
{{- end }}

# cargo
cargo = { binstall = true }

# node
node = {}

# npm - use bun instead
npm = { bun = true }

{{- if ne .chezmoi.os "windows" }}
# pipx - use uv instead
pipx = { uvx = true }
{{- end }}

# python
python = {}

# ruby
ruby = {}

[_]
# Comments and metadata

[env]
